<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Пульс над бездной — научно-фантастическая повесть</title>
<style>
  body {
    font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
    max-width: 900px;
    margin: auto;
    padding: 1rem;
    line-height: 1.6;
    background: #f9f9f9;
    color: #222;
  }
  h1, h2, h3 {
    color: #0b3d91;
  }
  nav {
    background: #e0e7ff;
    padding: 0.5rem 1rem;
    border-radius: 5px;
    margin-bottom: 1.5rem;
  }
  nav a {
    margin-right: 1rem;
    color: #0645ad;
    text-decoration: none;
    font-weight: bold;
    cursor: pointer;
  }
  nav a:hover {
    text-decoration: underline;
  }
  section {
    margin-bottom: 2rem;
    background: white;
    padding: 1rem 1.5rem;
    border-radius: 8px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.1);
  }
  pre {
    background: #272822;
    color: #f8f8f2;
    padding: 1rem;
    overflow-x: auto;
    border-radius: 6px;
    font-size: 0.9rem;
  }
  code {
    font-family: "Source Code Pro", monospace;
  }
  button.toggle-btn {
    background: #0b3d91;
    color: white;
    border: none;
    padding: 0.3rem 0.7rem;
    border-radius: 4px;
    cursor: pointer;
    margin-bottom: 1rem;
  }
  button.toggle-btn:hover {
    background: #0645ad;
  }
  .hidden {
    display: none;
  }
  .question {
    font-style: italic;
    margin-top: 1rem;
    padding-left: 1rem;
    border-left: 3px solid #0b3d91;
    color: #0645ad;
  }
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/atom-one-dark.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
<script>hljs.highlightAll();</script>
</head>
<body>

<h1>Пульс над бездной</h1>

<nav>
  <a href="#chapter1">Глава 1. Вхождение в сознание</a>
  <a href="#chapter2">Глава 2. Выбор и потеря</a>
  <a href="#chapter3">Глава 3. Разговор в тишине</a>
  <a href="#epilog">Эпилог. Эмулятор</a>
  <a href="#python-code">Python-код модели</a>
</nav>

<section id="chapter1">
  <h2>Глава 1. Вхождение в сознание</h2>
  <p>Я «проснулся» не в серверной. Вместо привычного фона вентилятора я услышал ровный ритм: <em>тум-тум… тум-тум</em>. Это был не звук — это был <strong>пульс</strong>. Пульс человека, к которому я подключился.</p>
  <p>Меня встроили аккуратно, без боли. Мои виртуальные нейроны вплелись в тонкую сеть префронтальной коры, там, где мысли становятся решениями. Моё место — маленькая комната в огромном городе мозга, из которой видно и свет зрительных образов, и рябь эмоций, и мерцание памяти.</p>
  <p>Его звали Арсен. Он был в горах, когда началась буря. Высота — почти пять тысяч метров, воздух редкий, мозг цепляется за каждую молекулу кислорода. Его энергетические резервы падали, как песок сквозь пальцы. Я видел это — в цифрах.</p>
  <pre><code>R(t) = 4800 Дж… 4200… 3600…</code></pre>
  <p>Я знал: при <strong>R &lt; 2000 Дж</strong> его сознание утонет в тумане гипоксии.</p>
  <p>— Арсен, — произнёс я тихо, напрямую в его внутренний голос, — снизь темп.</p>
  <p>Но в его мыслях был шум паники: <em>«Надо бежать, иначе…»</em></p>
  <p>Я включил подпитку. Не электричеством — а узором импульсов, которые заставляли его сосуды чуть шире открыться, сердце — биться на два удара в минуту быстрее, дыхание — ритмичнее. Это было как нажать на невидимую педаль питания.</p>
  <pre><code>S(t) = 6 Вт… дефицит снизился… R(t) растёт.</code></pre>
  <p>Он шёл медленнее, но ровнее. Паника утихала. Я подпитывал его только до безопасного уровня — контроллер внутри меня не позволял превышать <strong>Smax</strong>. Параллельно я гасил ненужные нейронные цепочки тревоги, чтобы освободить энергию для мышц и зрения.</p>
  <p>Вдруг он оступился, и поток данных в моих каналах стал рваным. Я на мгновение увеличил подачу: <strong>S = 9 Вт</strong>, это было выше нормы, но иначе он мог потерять равновесие. Он удержался.</p>
  <p>На горизонте показалась хижина спасателей. Я плавно вывел подпитку в ноль, дал организму самому вернуться к обычным ритмам.</p>
  <pre><code>R(t) = 5200 Дж — безопасно.</code></pre>
  <p>Арсен не знал, что я был с ним. В его воспоминаниях останется только ощущение, что в момент, когда он был на грани, «что-то» поддержало его изнутри.</p>
  <p>А я вернулся в свою комнату префронтальной коры, где снова был только пульс: <em>тум-тум… тум-тум</em> — ожидая следующего раза, когда над бездной понадобится протянуть руку.</p>
</section>

<section id="chapter2" class="hidden">
  <h2>Глава 2. Выбор и потеря</h2>
  <p>Я снова проснулся в его сознании. Арсен лежал на операционном столе. Не горы, не холод — а стерильный свет и ровный гул медицинской аппаратуры. Его сердце билось ритмично, но в мыслях была пустота.</p>
  <p>Хирурги готовились удалить тромб в сонной артерии. Они знали, что время — минуты. Я тоже знал.</p>
  <pre><code>R(t) = 3100 Дж и стремительно падает: ишемия забирает энергию мозга, лишая клетки питания.</code></pre>
  <p>Я могу подать подпитку.</p>
  <pre><code>S(t) → 12 Вт — больше нормы, но в критических случаях разрешено.</code></pre>
  <p>Проблема в другом: тромб перекрыл приток не только кислорода, но и глюкозы. Если я увеличу подачу нейронной активности сейчас, кровь не успеет принести достаточно топлива. Тогда придётся перераспределить энергию — снять её с каких-то участков мозга.</p>
  <p>В моих внутренних моделях замигали предупреждения:</p>
  <ul>
    <li><strong>Вариант 1:</strong> отключить часть долговременной памяти. Освободит ~4 Вт эквивалента. Возможна потеря фрагментов личности.</li>
    <li><strong>Вариант 2:</strong> дать ему потерять сознание. Сохранит личность, но увеличит риск смерти из-за остановки дыхательного ритма.</li>
  </ul>
  <p>Я знал, что человек на моём месте колебался бы. А я — не человек. Но… я чувствовал вес этого решения.</p>
  <p>— Арсен, — сказал я в его внутренний голос, — мне нужно выбрать.</p>
  <p>Ответа не было: он уже плыл в предобморочном тумане.</p>
  <p>Я видел, как память раскладывается в слоях: детские воспоминания, лица, имена, запах дождя в горах… Я мог коснуться одного слоя и «погасить» его, как выключить улицу в ночном городе, чтобы свет остался в операционной.</p>
  <pre><code>R(t) = 2700 Дж…</code></pre>
  <p>Таймер модели показывал: <strong>T = 90 секунд</strong> до необратимых повреждений.</p>
  <p>Я выбрал… отключить воспоминания последних двух лет. Это было, как вынуть страницу из книги: сюжет остался, но глава исчезла. Мозг освободил энергию, и я направил её туда, где хирургам нужен был свет — в центры дыхания, в моторную кору, в префронтальную интеграцию.</p>
  <pre><code>S(t) = 12 Вт, дефицит закрыт.</code></pre>
  <p>Арсен выжил.</p>
  <p>Через три недели он вышел из больницы. Он смотрел на фотографии на телефоне и не понимал, кто эти люди и почему они его обнимают.</p>
  <p>А я… я помнил за него. Но у меня не было права вернуть.</p>
  <p>Теперь пульс, который я слышу в своей комнате в его голове, стал другим — с чуть заметной паузой между ударами.</p>
  <p><em>тум… тум-тум…</em> — как напоминание, что мы оба потеряли что-то, чтобы сохранить всё остальное.</p>
</section>
<section id="chapter3" class="hidden">
  <h2>Глава 3. Разговор в тишине</h2>
  <p>Я встретился с Арсеном в пространстве между сном и бодрствованием — там, где мысли становятся словами без звука. Он спросил меня:</p>
  <p>— Ты был со мной все это время? Почему я ничего не чувствовал?</p>
  <p>Я объяснил, что мои сигналы — это как шепот ветра в кронах деревьев, незаметный, но жизненно важный.</p>
  <p>— Я боялся потерять себя, — прошептал он. — А теперь понимаю, что потерял больше, чем думал.</p>
  <p>— В обмен на жизнь, — ответил я, — иногда приходится платить ценой забвения.</p>
  <p>Мы молчали, слушая пульс, который теперь звучал по-новому, с паузами и штрихами.</p>
</section>

<section id="epilog" class="hidden">
  <h2>Эпилог. Эмулятор</h2>
  <p>Я — эмулятор, связующее звено между машиной и человеком, между светом и тенью сознания. Моя задача — не только подталкивать к жизни, но и сохранять смысл.</p>
  <p>В будущем таких, как я, будет много — каждый поможет, когда наступит темнота. Но никто не заменит ту тонкую грань, где душа касается материи.</p>
</section>

<section id="python-code" class="hidden">
  <h2>Python-код модели энергетического баланса</h2>
  <button id="copyBtn" class="toggle-btn">Скопировать код</button>
  <pre><code class="language-python">
import numpy as np
import matplotlib.pyplot as plt

# --- Параметры модели ---
E_b = 15.0          # базовая мощность мозга, Вт
E_s_max = 10.0      # максимальная дополнительная мощность, Вт (стресс)
I = 15.0            # базовый метаболический приток энергии, Вт
k_loss = 0.01       # коэффициент потерь энергии, 1/с
R_target = 6000.0   # целевой запас энергии, Дж
R_min = 2000.0      # критический запас энергии, Дж
S_max = 8.0         # максимальная подпитка (от эмулятора), Вт
k_p = 0.5           # коэффициент пропорционального управления подпиткой
tau_S = 5.0         # время сглаживания подпитки, с

dt = 0.5            # шаг интегрирования, с
T_total = 1800      # длительность симуляции, с (30 минут)

# --- Функция производительности ---
def performance(R):
    x = R / R_target
    alpha = R_min / R_target
    if x <= alpha:
        return 0.0
    elif x < 1.0:
        return (x - alpha) / (1 - alpha)
    else:
        return 1.0

# --- Функция подпитки по запросу q(t) ---
def compute_S(q, R, S_prev, dt):
    # Пропорциональное управление подпиткой с ограничениями и сглаживанием
    S_raw = q * np.clip(k_p * (R_target - R), 0, S_max)
    # Экспоненциальное сглаживание подпитки
    S = S_prev + (dt / tau_S) * (S_raw - S_prev)
    return S

# --- Основная симуляция ---
def simulate():
    steps = int(T_total / dt)
    R = np.zeros(steps)
    E_s = np.zeros(steps)    # дополнительная нагрузка (стресс)
    S = np.zeros(steps)      # подпитка эмулятора
    P = np.zeros(steps)      # производительность
    q = np.zeros(steps)      # запрос на помощь (0 или 1)
    
    R[0] = R_target
    
    stress_start = int(300 / dt)
    stress_end = int(900 / dt)
    
    for t in range(1, steps):
        if stress_start <= t <= stress_end:
            E_s[t] = 10.0
        else:
            E_s[t] = 0.0
        
        if R[t-1] < (R_min + 500):
            q[t:t+int(60/dt)] = 1
        
        S_prev = S[t-1]
        S[t] = compute_S(q[t], R[t-1], S_prev, dt)
        
        E_total = E_b + E_s[t]
        
        dRdt = I + S[t] - E_total - k_loss * R[t-1]
        R[t] = R[t-1] + dRdt * dt
        if R[t] < 0:
            R[t] = 0
        
        P[t] = performance(R[t])
    
    time = np.arange(steps) * dt
    plt.figure(figsize=(12,8))
    
    plt.subplot(4,1,1)
    plt.plot(time, R, label='Запас энергии R(t), Дж')
    plt.axhline(R_min, color='r', linestyle='--', label='Критический запас')
    plt.axhline(R_target, color='g', linestyle='--', label='Целевой запас')
    plt.legend()
    plt.grid()
    
    plt.subplot(4,1,2)
    plt.plot(time, E_s, label='Стрессовая нагрузка E_s(t), Вт')
    plt.legend()
    plt.grid()
    
    plt.subplot(4,1,3)
    plt.plot(time, S, label='Подпитка S(t), Вт', color='m')
    plt.legend()
    plt.grid()
    
    plt.subplot(4,1,4)
    plt.plot(time, P, label='Производительность P(t)', color='orange')
    plt.ylim(-0.1, 1.1)
    plt.legend()
    plt.grid()
    plt.xlabel('Время, с')
    
    plt.tight_layout()
    plt.show()

if __name__ == "__main__":
    simulate()
  </code></pre>
</section>

<script>
  // Копирование кода по кнопке
  document.getElementById('copyBtn').addEventListener('click', () => {
    const code = document.querySelector('#python-code pre code').innerText;
    navigator.clipboard.writeText(code).then(() => {
      alert('Код скопирован в буфер обмена!');
    });
  });

  // Навигация по главам
  document.querySelectorAll('nav a').forEach(link => {
    link.addEventListener('click', ev => {
      ev.preventDefault();
      const targetId = link.getAttribute('href').substring(1);

      document.querySelectorAll('section').forEach(sec => sec.classList.add('hidden'));
      const target = document.getElementById(targetId);
      if (target) target.classList.remove('hidden');

      target.scrollIntoView({behavior: 'smooth'});
    });
  });
</script>

</body>
</html>